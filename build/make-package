#!/bin/bash
#===============================================================================
#
#          FILE:  make-package
#
#         USAGE:  ./make-package
#
#   DESCRIPTION:  Makes creamsn0w package.
#
#        AUTHOR:  Sorin Ionescu <sorin.ionescu@gmail.com>
#       VERSION:  1.0.0
#       CREATED:  2009-07-26 16:18:54-04:00
#===============================================================================

VERSION=`git tag | tail -n 1`
BUNDLE_NAME='creamsn0w'
BUNDLE="${BUNDLE_NAME}.bundle"
PACKAGE_NAME="${BUNDLE_NAME}_${VERSION}"
PACKAGE="${PACKAGE_NAME}.zip"
SRC="../src/"

cd $( dirname $0 )

# Start clean.
rm -rf *.zip 
mkdir -p tmp/$BUNDLE
mkdir -p tmp/addons

cp $SRC/Info.plist tmp/$BUNDLE/
cp -r $SRC/files  tmp/$BUNDLE/
cp $SRC/scripts/* tmp
cp ../doc/* tmp

cd tmp
find . -type f -name '.DS_Store' -delete;

zip -qq -r -y $BUNDLE.zip $BUNDLE
rm -rf $BUNDLE
echo "Making package $PACKAGE."
zip -qq -r -y $PACKAGE *
mv $PACKAGE ..
cd ..

# Cleanup
rm -rf tmp
